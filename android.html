<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#F7F4F2" />
  <title>Androidで置くAR｜かなたけちゃんAR</title>

  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    :root{
      --ink:#1B1B1F; --sub:#5B5B67;
      --brand:#E94B5A; --brand2:#FF7A7A;
      --stroke:#00000010; --shadow:0 18px 50px rgba(16,24,40,.12);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", "Segoe UI", sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 20% 0%, #FFE7EA 0%, transparent 60%),
        radial-gradient(900px 500px at 90% 10%, #E8F5FF 0%, transparent 55%),
        linear-gradient(180deg, #F7F4F2, #FFFFFF);
      min-height:100vh;
    }
    .wrap{max-width:900px;margin:0 auto;padding:22px 16px 34px;}
    h1{margin:0 0 6px;font-size:24px;}
    p{margin:8px 0 0;color:var(--sub);line-height:1.7;font-size:13px;}
    .panel{
      margin-top:14px;
      background:#FFFFFFCC;
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      backdrop-filter: blur(8px);
    }
    model-viewer{
      width:100%;
      height:min(72vh, 560px);
      background: linear-gradient(180deg,#FFF,#F7F7FA);
      border-radius:16px;
      border:1px solid var(--stroke);
    }
    .btnrow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}
    a.back{
      display:inline-flex;align-items:center;gap:8px;
      text-decoration:none;color:var(--ink);
      padding:10px 12px;border-radius:12px;
      background:#FFFFFFAA;border:1px solid var(--stroke);
    }

    /* ARボタン（model-viewerのslot="ar-button"） */
    .arbtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      font-weight:800;
      letter-spacing:.02em;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 16px 30px rgba(233,75,90,.28);
    }
    .hint{
      margin-top:10px;
      font-size:12px;
      color:var(--sub);
      line-height:1.75;
    }
    .warn{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      background:#FFF4F4;
      border:1px solid #00000010;
      color:#7A1C1C;
      font-size:12px;
      line-height:1.7;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Androidで置くAR</h1>
    <p>対応端末では「ARで表示」ボタンからカメラが起動します。</p>

    <div class="panel">
      <model-viewer
        id="mv"
        src="./onigiri.glb"
        poster="./kanatake.png"
        alt="かなたけちゃん"
        camera-controls
        ar
        ar-modes="webxr scene-viewer"
        shadow-intensity="0"
        autoplay
        reveal="auto">
        <button class="arbtn" slot="ar-button">ARで表示する</button>
      </model-viewer>

      <div class="warn" id="warn">
        この端末ではARが利用できない可能性があります（ARCore未対応、または「Google Play Services for AR」が未導入など）。<br>
        その場合でも、上の3D表示（指で回す）はご利用いただけます。
      </div>

      <div class="hint">
        うまくいかない場合：Chromeで開く／「Google Play Services for AR」を導入後に再試行してください。<br>
        SNSアプリ内ブラウザは不安定な場合があります。
      </div>

      <div class="btnrow">
        <a class="back" href="./index.html">← トップへ戻る</a>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const mv = document.getElementById('mv');
      const warn = document.getElementById('warn');

      // model-viewerがAR起動できない場合の案内
      // 一部端末は判定が遅いので少し待つ
      setTimeout(() => {
        try{
          if (!mv.canActivateAR) warn.style.display = 'block';
        }catch(e){
          warn.style.display = 'block';
        }
      }, 700);
    })();
  </script>
</body>
</html>
